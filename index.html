<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>BananaGuava - Prompts Vault</title>
    <link rel="stylesheet" href="bananaGuava.css" />
</head>

<body>
    <header>
        <div class="container">
            <h1>🍌 BananaGuava 🍐</h1>
            <p>香蕉與芭樂的靈感碰撞 - 蒐集與分享你的提示詞精華</p>
            <p class="tagline-sub">香蕉你個芭樂：這裡不產水果，只產讓 AI 聽懂人話的神提示</p>
        </div>
    </header>

    <div class="container">
        <section class="tribute-banner">
            <p style="margin-bottom: 12px; font-size: 1.1rem; font-weight: 700; color: var(--accent-banana);">
                💡 建議安裝 <a
                    href="https://chromewebstore.google.com/detail/chatgpt-%E8%90%AC%E8%83%BD%E5%B7%A5%E5%85%B7%E7%AE%B1/fmijcafgekkphdijpclfgnjhchmiokgp?authuser=0&hl=zh-TW"
                    target="_blank" rel="noopener" style="text-decoration: underline;">"ChatGPT 萬能工具箱"</a>
            </p>
            <p style="opacity: 0.7; font-size: 0.85rem;">
                本專案為學習用途，旨在向原作者致敬並嘗試重現其設計理念。參考專案：
                <a href="https://mukiwu.github.io/prompts-vault/" target="_blank" rel="noopener">Prompts Vault</a>
            </p>
        </section>
    </div>

    <main class="container">
        <section class="toolbar">
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="搜尋標題、內容..." />
            </div>

            <div class="filters">
                <div class="toggle-container">
                    <label class="switch">
                        <input type="checkbox" id="previewToggle">
                        <span class="slider round"></span>
                    </label>
                    <span class="toggle-label">顯示預覽 (Pending)</span>
                </div>

                <select id="tagFilter">
                    <option value="">所有標籤</option>
                </select>

                <button class="btn btn-primary" id="submitBtn">
                    🍌 投稿你的香蕉拔辣 🍐
                </button>
            </div>
        </section>

        <section id="categoryFilters" class="category-filters">
            <!-- Category badges will be rendered here -->
        </section>

        <section id="stats" class="stats-bar">
            <span id="statsText">正在載入提示詞...</span>
            <div class="items-per-page-control">
                <label for="itemsPerPage">每頁顯示：</label>
                <select id="itemsPerPage">
                    <option value="12">12</option>
                    <option value="24" selected>24</option>
                    <option value="48">48</option>
                    <option value="100">100</option>
                </select>
            </div>
        </section>

        <section id="promptContainer" class="prompt-grid">
            <!-- Cards will be rendered here by bananaGuava.js -->
        </section>

        <section id="pagination" class="pagination-container">
            <!-- Pagination will be rendered here -->
        </section>
    </main>

    <!-- Anonymous Submit Form Modal -->
    <div id="submitFormModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <span class="close-button" id="closeSubmitForm">&times;</span>
            <div style="padding: 40px;">
                <h2 style="margin-bottom: 20px;">匿名投稿</h2>
                <form id="anonSubmissionForm">
                    <div class="form-group" style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px; color: var(--accent-banana);">標題 *</label>
                        <input type="text" id="formTitle" required placeholder="例如：寫實人像"
                            style="width: 100%; padding: 10px; border-radius: 8px; background: #1e293b; border: 1px solid #334155; color: white;">
                    </div>
                    <div class="form-group" style="margin-bottom: 15px; position: relative;">
                        <label style="display: block; margin-bottom: 5px; color: var(--accent-banana);">提示詞內容 *</label>
                        <textarea id="formPrompt" required rows="5"
                            style="width: 100%; padding: 10px; border-radius: 8px; background: #1e293b; border: 1px solid #334155; color: white; font-family: monospace;"
                            placeholder="請貼上您的提示詞內容。&#10;可以使用 {{變數}} 或 {{變數:預設值}} 建立欄位。&#10;提示：您可以在此處直接 Ctrl+V 貼上預覽圖。&#10;並在下方「變數設定」區域新增變數及其選項。"></textarea>
                        <div id="varSuggestions" class="suggestions-dropdown" style="display: none;"></div>
                    </div>

                    <div class="form-group" style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px; color: var(--accent-banana);">變數選項設定
                            (Variables)</label>
                        <p style="font-size: 0.8em; color: var(--text-muted); margin-bottom: 8px;">
                            系統會自動偵測提示詞中的 {{變數}}。請在下方為偵測到的變數加入選項 (輸入文字後按 Enter 新增)。
                        </p>
                        <div id="varsBuilderContainer"
                            style="margin-bottom: 10px; display: flex; flex-direction: column; gap: 8px;"></div>
                    </div>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                        <div class="form-group">
                            <label style="display: block; margin-bottom: 5px; color: var(--accent-banana);">分類</label>
                            <select id="formCategorySelect"
                                style="width: 100%; padding: 10px; border-radius: 8px; background: #1e293b; border: 1px solid #334155; color: white; cursor: pointer;">
                                <option value="">請選擇分類...</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label style="display: block; margin-bottom: 5px; color: var(--accent-banana);">標籤</label>
                            <div id="formTagsContainer"
                                style="display: flex; flex-wrap: wrap; gap: 6px; padding: 8px; border-radius: 8px; background: #1e293b; border: 1px solid #334155; min-height: 42px;">
                                <input type="text" id="formTagsInput" placeholder="輸入後按 Enter 新增"
                                    style="flex: 1; min-width: 120px; background: transparent; border: none; color: white; outline: none; padding: 2px 0;">
                            </div>
                            <input type="hidden" id="formTags" value="">
                        </div>
                    </div>
                    <div class="form-group" style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px; color: var(--accent-banana);">上傳預覽圖
                            (選填)</label>
                        <input type="file" id="formImageFile" accept="image/*"
                            style="width: 100%; padding: 10px; border-radius: 8px; background: #1e293b; border: 1px solid #334155; color: white; cursor: pointer;">
                        <div id="formImagePreviewContainer"
                            style="margin-top: 10px; display: none; text-align: center;">
                            <p
                                style="font-size: 0.8em; color: var(--text-muted); margin-bottom: 5px; text-align: left;">
                                預覽：</p>
                            <img id="formImagePreview" src="" alt="Image Preview"
                                style="max-width: 100%; max-height: 200px; border-radius: 8px; border: 1px solid #334155;">
                            <button type="button" id="removeImageBtn" class="btn btn-sm btn-outline"
                                style="margin-top: 5px; width: 100%;">❌ 移除圖片</button>
                        </div>
                    </div>
                    <div class="form-group" style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 5px; color: var(--accent-banana);">作者 / 來源</label>
                        <textarea id="formSource" rows="1" placeholder="可選填，例如：@yisuchen 或 原始網址"
                            style="width: 100%; padding: 10px; border-radius: 8px; background: #1e293b; border: 1px solid #334155; color: white;"></textarea>
                    </div>

                    <div class="form-group" style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 5px; color: var(--accent-banana);">編輯密碼 *
                            (修改時需驗證)</label>
                        <input type="password" id="formPassword" required placeholder="請輸入 4-12 位英數密碼"
                            style="width: 100%; padding: 10px; border-radius: 8px; background: #1e293b; border: 1px solid #334155; color: white;">
                    </div>

                    <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                        <button type="submit" id="submitAnonBtn" class="btn btn-guava" style="flex: 1;">
                            🚀 匿名投稿
                        </button>
                    </div>
                    <p id="submitStatus" style="margin-top: 15px; text-align: center; display: none;"></p>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal for Detailed View -->
    <div id="promptModal" class="modal">
        <div class="modal-content">
            <span class="close-button" aria-label="Close">&times;</span>

            <div class="modal-body">
                <!-- Top Section: Visual and Metadata -->
                <div class="modal-header-section">
                    <div class="modal-left">
                        <img id="modalImage" src="" alt="Preview" />
                    </div>

                    <div class="modal-right">
                        <div class="modal-info" style="gap: 20px;">
                            <div class="info-group">
                                <div id="modalCategory" class="card-category-tag"></div>
                            </div>

                            <div id="modalVariablesGroup" class="info-group"
                                style="display: none; background: rgba(0,0,0,0.2); padding: 10px; border-radius: 8px;">
                                <label style="color: var(--accent-banana); margin-bottom: 10px; display: block;">變數替換
                                    (Variables)</label>
                                <div id="modalVariablesList" style="display: flex; flex-direction: column; gap: 10px;">
                                </div>
                            </div>

                            <div id="modalSourceGroup" class="info-group" style="display: none;">
                                <label>作者 / 來源</label>
                                <div id="modalSource" class="info-value"></div>
                            </div>

                            <div id="modalTagsGroup" class="info-group">
                                <div id="modalTags" class="tag-list"></div>
                            </div>

                            <div class="modal-action-buttons"
                                style="display: flex; gap: 10px; flex-wrap: wrap; margin-top: auto;">
                                <a href="#" id="modalEditBtn" target="_blank" rel="noopener" class="btn btn-outline"
                                    style="flex: 1; min-width: 120px; text-align: center;">
                                    📝 查看
                                </a>
                                <button id="modalAnonEditBtn" class="btn btn-outline"
                                    style="flex: 1; min-width: 120px; text-align: center;">
                                    👤 編輯
                                </button>
                                <a href="#" id="modalShareLink" target="_blank" rel="noopener" class="btn btn-outline"
                                    style="flex: 2; min-width: 200px;">
                                    🍌 投稿你的香蕉拔辣
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Bottom Section: Prompt and Notes -->
                <div class="modal-content-section">
                    <div class="info-group">
                        <div class="info-header" style="justify-content: space-between;">
                            <label style="margin-bottom: 0;">提示詞內容 (Prompt Content)</label>
                            <div style="display: flex; gap: 10px;">
                                <button id="modalCopyBtn" class="btn btn-sm" type="button">
                                    📋 複製
                                </button>
                                <button id="modalGenBtn" class="btn btn-guava" type="button">
                                    🍌 蕉換芭樂
                                </button>
                            </div>
                        </div>
                        <div id="modalPrompt" class="prompt-display" style="max-height: none; overflow: visible;"></div>
                    </div>

                    <div id="modalNotesGroup" class="info-group" style="margin-top: 30px; display: none;">
                        <label>使用說明</label>
                        <div id="modalNotes" class="info-value" style="white-space: pre-wrap;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Password Verify Modal -->
    <div id="passwordModal" class="modal">
        <div class="modal-content" style="max-width: 400px;">
            <span class="close-button" id="closePasswordModal">&times;</span>
            <div style="padding: 40px; text-align: center;">
                <h2 style="margin-bottom: 20px;">身份驗證</h2>
                <p style="color: var(--text-muted); margin-bottom: 20px;">請輸入此投稿的編輯密碼</p>
                <input type="password" id="verifyPasswordInput" placeholder="請輸入密碼"
                    style="width: 100%; padding: 12px; border-radius: 8px; background: #1e293b; border: 1px solid #334155; color: white; margin-bottom: 20px; text-align: center;">
                <button id="confirmPasswordBtn" class="btn btn-primary" style="width: 100%;">
                    確認
                </button>
            </div>
        </div>
    </div>

    <footer>
        <div class="container">
            <p>&copy; 2025 BananaGuava - Powered by GitHub Issues</p>
        </div>
    </footer>

    <script src="bananaGuava.js"></script>
</body>

</html>